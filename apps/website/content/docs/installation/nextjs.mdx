# Prose UI with Next.js and Content Collections

## Create a new project

Start by creating a Next.js project, choosing the recommended Next.js defaults in the prompt.

```bash title="Create a new Next.js project"
npx create-next-app@latest
```

## Set up MDX rendering with Content Collections

[Content Collections](https://www.content-collections.dev/docs/quickstart/next) is a library that will help us to keep our mdx content organized, and will render our MDX files. Content collections setup below is based on [Content Collections Next.js](https://www.content-collections.dev/docs/quickstart/next) and [MDX guides](https://www.content-collections.dev/docs/content/mdx).

<Callout variant="note">
  You can set up Prose UI with `next/mdx` as well. But we're going to use Content Collections library in this example because it will help us keep our Markdown files organized in a single folder, and provide a better developer experience.&#x20;
</Callout>

Install packages

```bash
npm install @content-collections/core @content-collections/next @content-collections/mdx zod -D
```

Add content-collections path to your `tsconfig.json`

```json title="tsconfig.json"
{
  "compilerOptions": {
    // ...
    "paths": {
      "@/*": ["./*"],
      "content-collections": ["./.content-collections/generated"]
    }
  }
}
```

Modify your Next.js configuration

```typescript title="next.config.ts"
import type { NextConfig } from "next";
import { withContentCollections } from "@content-collections/next";
 
const nextConfig: NextConfig = {};
 
export default withContentCollections(nextConfig);
```

Add .content-collections to `.gitignore`

```title=".gitignore"
.content-collections
```

Create `content-collections.ts` file at the root of your project:

```typescript
import { defineCollection, defineConfig } from "@content-collections/core";
import { compileMDX } from "@content-collections/mdx";
import { z } from "zod";
 
const posts = defineCollection({
  name: "posts",
  directory: "content",
  include: "**/*.mdx",
  schema: z.object({
    content: z.string(),
  }),
  transform: async (document, context) => {
    const mdx = await compileMDX(context, document);
    return {
      ...document,
      mdx,
    };
  },
});
 
export default defineConfig({
  collections: [posts],
});
```

## Set up Prose UI and Markdown rendering

Install dependencies

```bash
npm install @prose-ui/core @prose-ui/next @prose-ui/style
```

Import styles into your `globals.css`.

```css
@import "@prose-ui/style/prose-ui.css";
@import "@prose-ui/style/katex.min.css";
```

In your `content-collections.ts` initialize and pass `remarkPlugins` to the MDX compiler.

```typescript title="content-collections.ts"
import { remarkPlugins } from '@prose-ui/core'

// ...
const content = await compileMDX(ctx, page, {
   remarkPlugins: remarkPlugins(),
})
// ...
```

Create the page that will render your Markdown: `/app/posts/[[...path]]/page.tsx` where you render your Markdown pass Prose UI `mdxComponents` into the MDXContent, and wrap the content into a tag with a `prose-ui` css class.

```tsx title="/app/posts/[[...path]]/page.tsx"
import { notFound } from "next/navigation";
import { allPosts } from "content-collections";
import { mdxComponents } from "@prose-ui/next";
import { MDXContent } from "@content-collections/mdx/react";


type Params = Promise<{ path: string[] }>
type PageProps = {
  params: Params
}

const findPage = (pathArr: string[]) => {
  const path = pathArr ? `${pathArr.join('/')}` : '/'
  return allPosts.find((page) => page._meta.path === path)
}

export async function generateStaticParams() {
  return allPosts.map((page) => ({
    path: page._meta.path.slice(1).split('/'),
  }))
}

export default async function Page({
  params,
}: PageProps) {
  const { path } = await params
  let page = findPage(path)
  if (!page) notFound();

  return (
    <article className="prose-ui w-full max-w-5xl mx-auto">
      <MDXContent code={page.mdx} components={mdxComponents} />
    </article>
  )
}
```

Add your first page

Create a folder `content/pages` and add your a page

```markdown title="content/posts/hello.mdx"
# Hello, world!

This stunning image is from [NASA's Juno mission](https://science.nasa.gov/mission/juno).

<Frame>
  <Image
    src="https://media.dhub.dev/jupiter-cropped.jpg"
    alt="Jupiter"
  />
  <Caption>Juno Captures Jupiter. Credits: NASA/JPL-Caltech/SwRI/MSSS, Thomas Thomopoulos Â© CC BY</Caption>
</Frame>
```

Run your project and localhost:3000/posts/hello should point to the rendered MDX page.
